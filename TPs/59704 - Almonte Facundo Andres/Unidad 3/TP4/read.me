# üìã Sistema de Gesti√≥n de Proyectos y Tareas

API RESTful construida con FastAPI y SQLite para gestionar proyectos y sus tareas asociadas, con soporte para filtros, estad√≠sticas y relaciones en cascada.

---

## üìë Tabla de Contenidos

- [Caracter√≠sticas](#-caracter√≠sticas)
- [Requisitos Previos](#-requisitos-previos)
- [Instalaci√≥n](#-instalaci√≥n)
- [Iniciar el Servidor](#-iniciar-el-servidor)
- [Estructura de la Base de Datos](#-estructura-de-la-base-de-datos)
- [Relaciones entre Tablas](#-relaciones-entre-tablas)
- [Endpoints de la API](#-endpoints-de-la-api)
- [Ejemplos de Uso](#-ejemplos-de-uso)

---

## ‚ú® Caracter√≠sticas

- ‚úÖ CRUD completo para proyectos y tareas
- ‚úÖ Relaciones con integridad referencial (CASCADE)
- ‚úÖ Filtros avanzados (por estado, prioridad, proyecto)
- ‚úÖ Estad√≠sticas y res√∫menes
- ‚úÖ Validaciones autom√°ticas con Pydantic
- ‚úÖ Documentaci√≥n interactiva (Swagger/ReDoc)

---

## üîß Requisitos Previos

- Python 3.8 o superior
- pip (gestor de paquetes de Python)

---

## üì¶ Instalaci√≥n

### 1. Clonar o descargar el proyecto

```bash
cd tu-proyecto
```

### 2. Crear entorno virtual (recomendado)

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python3 -m venv venv
source venv/bin/activate
```

### 3. Instalar dependencias

```bash
pip install fastapi uvicorn pydantic
```

### 4. Verificar estructura de archivos

```
proyecto/
‚îÇ
‚îú‚îÄ‚îÄ main.py          # Archivo principal con la API
‚îú‚îÄ‚îÄ models.py        # Modelos Pydantic
‚îî‚îÄ‚îÄ proyectos.db     # Base de datos (se crea autom√°ticamente)
```

---

## üöÄ Iniciar el Servidor

### M√©todo 1: Ejecutar directamente

```bash
python main.py
```

### M√©todo 2: Usar Uvicorn manualmente

```bash
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

**Par√°metros:**
- `--reload`: Recarga autom√°tica al detectar cambios (desarrollo)
- `--host 0.0.0.0`: Permite acceso desde otras m√°quinas
- `--port 8000`: Puerto del servidor

### Acceder a la documentaci√≥n

Una vez iniciado el servidor:

- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc
- **API Base**: http://localhost:8000

---

## üóÑÔ∏è Estructura de la Base de Datos

### Diagrama de Relaciones

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ        PROYECTOS            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ id (PK)          INTEGER    ‚îÇ
‚îÇ nombre           TEXT       ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ descripcion      TEXT       ‚îÇ      ‚îÇ
‚îÇ fecha_creacion   TEXT       ‚îÇ      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
                                      ‚îÇ
                                      ‚îÇ ON DELETE CASCADE
                                      ‚îÇ
                                      ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ          TAREAS             ‚îÇ      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§      ‚îÇ
‚îÇ id (PK)          INTEGER    ‚îÇ      ‚îÇ
‚îÇ descripcion      TEXT       ‚îÇ      ‚îÇ
‚îÇ estado           TEXT       ‚îÇ      ‚îÇ
‚îÇ prioridad        TEXT       ‚îÇ      ‚îÇ
‚îÇ fecha_creacion   TEXT       ‚îÇ      ‚îÇ
‚îÇ proyecto_id (FK) INTEGER    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Tabla: `proyectos`

| Campo           | Tipo    | Restricciones                    | Descripci√≥n                        |
|-----------------|---------|----------------------------------|------------------------------------|
| id              | INTEGER | PRIMARY KEY, AUTOINCREMENT       | Identificador √∫nico del proyecto   |
| nombre          | TEXT    | NOT NULL, UNIQUE                 | Nombre del proyecto                |
| descripcion     | TEXT    | NULL                             | Descripci√≥n opcional               |
| fecha_creacion  | TEXT    | NOT NULL                         | Fecha de creaci√≥n (ISO 8601)       |

### Tabla: `tareas`

| Campo           | Tipo    | Restricciones                     | Descripci√≥n                        |
|-----------------|---------|-----------------------------------|------------------------------------|
| id              | INTEGER | PRIMARY KEY, AUTOINCREMENT        | Identificador √∫nico de la tarea    |
| descripcion     | TEXT    | NOT NULL                          | Descripci√≥n de la tarea            |
| estado          | TEXT    | NOT NULL, DEFAULT 'pendiente'     | Estado: pendiente, en_progreso, completada |
| prioridad       | TEXT    | NOT NULL, DEFAULT 'media'         | Prioridad: baja, media, alta       |
| fecha_creacion  | TEXT    | NOT NULL                          | Fecha de creaci√≥n (ISO 8601)       |
| proyecto_id     | INTEGER | FOREIGN KEY ‚Üí proyectos(id)       | Referencia al proyecto padre       |

---

## üîó Relaciones entre Tablas

### Relaci√≥n Uno a Muchos (1:N)

**Un proyecto puede tener muchas tareas, pero cada tarea pertenece a un solo proyecto.**

```
PROYECTOS (1) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ
                    ‚îÇ tiene muchas
                    ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ> TAREAS (N)
```

### Foreign Key con CASCADE

La clave for√°nea `proyecto_id` en la tabla `tareas` implementa la restricci√≥n:

```sql
FOREIGN KEY (proyecto_id) REFERENCES proyectos(id) ON DELETE CASCADE
```

**Comportamiento:**
- ‚úÖ **Integridad referencial**: No se pueden crear tareas con un `proyecto_id` inexistente
- ‚úÖ **Eliminaci√≥n en cascada**: Al eliminar un proyecto, todas sus tareas se eliminan autom√°ticamente
- ‚úÖ **Protecci√≥n de datos**: Evita tareas hu√©rfanas en la base de datos

**Ejemplo pr√°ctico:**

```
Proyecto "Web App" (id=1)
  ‚îú‚îÄ‚îÄ Tarea "Dise√±ar UI" (id=1, proyecto_id=1)
  ‚îú‚îÄ‚îÄ Tarea "Backend API" (id=2, proyecto_id=1)
  ‚îî‚îÄ‚îÄ Tarea "Testing" (id=3, proyecto_id=1)

Si eliminas el proyecto con id=1:
  ‚Üí Las tareas 1, 2 y 3 se eliminan autom√°ticamente
```

---

## üåê Endpoints de la API

### Proyectos

| M√©todo | Endpoint                     | Descripci√≥n                           |
|--------|------------------------------|---------------------------------------|
| POST   | `/proyectos`                 | Crear un nuevo proyecto               |
| GET    | `/proyectos`                 | Listar todos los proyectos            |
| GET    | `/proyectos/{proyecto_id}`   | Obtener un proyecto espec√≠fico        |
| PUT    | `/proyectos/{proyecto_id}`   | Actualizar un proyecto                |
| DELETE | `/proyectos/{proyecto_id}`   | Eliminar un proyecto (y sus tareas)   |
| GET    | `/proyectos/{proyecto_id}/resumen` | Estad√≠sticas del proyecto    |

### Tareas

| M√©todo | Endpoint                                | Descripci√≥n                          |
|--------|-----------------------------------------|--------------------------------------|
| POST   | `/proyectos/{proyecto_id}/tareas`       | Crear tarea en un proyecto           |
| GET    | `/proyectos/{proyecto_id}/tareas`       | Listar tareas de un proyecto         |
| GET    | `/tareas`                               | Listar todas las tareas (con filtros)|
| PUT    | `/tareas/{tarea_id}`                    | Actualizar una tarea                 |
| DELETE | `/tareas/{tarea_id}`                    | Eliminar una tarea                   |

### Resumen

| M√©todo | Endpoint    | Descripci√≥n                           |
|--------|-------------|---------------------------------------|
| GET    | `/resumen`  | Estad√≠sticas generales del sistema    |

---

## üìñ Ejemplos de Uso

### 1. Crear un Proyecto

**Request:**

```bash
curl -X POST http://localhost:8000/proyectos \
  -H "Content-Type: application/json" \
  -d '{
    "nombre": "Aplicaci√≥n Web E-commerce",
    "descripcion": "Plataforma de ventas online con carrito de compras"
  }'
```

**JSON Body:**

```json
{
  "nombre": "Aplicaci√≥n Web E-commerce",
  "descripcion": "Plataforma de ventas online con carrito de compras"
}
```

**Response (201):**

```json
{
  "id": 1,
  "nombre": "Aplicaci√≥n Web E-commerce",
  "descripcion": "Plataforma de ventas online con carrito de compras",
  "fecha_creacion": "2024-11-06T15:30:00.123456",
  "total_tareas": null
}
```

---

### 2. Listar Todos los Proyectos

**Request:**

```bash
curl -X GET http://localhost:8000/proyectos
```

**Con filtro por nombre:**

```bash
curl -X GET "http://localhost:8000/proyectos?nombre=web"
```

**Response (200):**

```json
[
  {
    "id": 1,
    "nombre": "Aplicaci√≥n Web E-commerce",
    "descripcion": "Plataforma de ventas online con carrito de compras",
    "fecha_creacion": "2024-11-06T15:30:00.123456",
    "total_tareas": null
  },
  {
    "id": 2,
    "nombre": "Web Corporativa",
    "descripcion": "Sitio web institucional",
    "fecha_creacion": "2024-11-06T16:00:00.123456",
    "total_tareas": null
  }
]
```

---

### 3. Obtener un Proyecto Espec√≠fico

**Request:**

```bash
curl -X GET http://localhost:8000/proyectos/1
```

**Response (200):**

```json
{
  "id": 1,
  "nombre": "Aplicaci√≥n Web E-commerce",
  "descripcion": "Plataforma de ventas online con carrito de compras",
  "fecha_creacion": "2024-11-06T15:30:00.123456",
  "total_tareas": 5
}
```

---

### 4. Actualizar un Proyecto

**Request:**

```bash
curl -X PUT http://localhost:8000/proyectos/1 \
  -H "Content-Type: application/json" \
  -d '{
    "nombre": "E-commerce Mejorado",
    "descripcion": "Plataforma con integraci√≥n de pagos"
  }'
```

**JSON Body (parcial):**

```json
{
  "descripcion": "Nueva descripci√≥n actualizada"
}
```

**Response (200):**

```json
{
  "id": 1,
  "nombre": "E-commerce Mejorado",
  "descripcion": "Plataforma con integraci√≥n de pagos",
  "fecha_creacion": "2024-11-06T15:30:00.123456",
  "total_tareas": null
}
```

---

### 5. Eliminar un Proyecto

**Request:**

```bash
curl -X DELETE http://localhost:8000/proyectos/1
```

**Response (200):**

```json
{
  "mensaje": "Proyecto eliminado exitosamente",
  "tareas_eliminadas": 5
}
```

---

### 6. Crear una Tarea

**Request:**

```bash
curl -X POST http://localhost:8000/proyectos/1/tareas \
  -H "Content-Type: application/json" \
  -d '{
    "descripcion": "Implementar sistema de login",
    "estado": "pendiente",
    "prioridad": "alta"
  }'
```

**JSON Body:**

```json
{
  "descripcion": "Implementar sistema de login",
  "estado": "en_progreso",
  "prioridad": "alta"
}
```

**Valores v√°lidos:**
- **estado**: `pendiente`, `en_progreso`, `completada`
- **prioridad**: `baja`, `media`, `alta`

**Response (201):**

```json
{
  "id": 1,
  "descripcion": "Implementar sistema de login",
  "estado": "pendiente",
  "prioridad": "alta",
  "fecha_creacion": "2024-11-06T16:45:00.123456",
  "proyecto_id": 1
}
```

---

### 7. Listar Tareas de un Proyecto

**Request:**

```bash
curl -X GET http://localhost:8000/proyectos/1/tareas
```

**Response (200):**

```json
[
  {
    "id": 1,
    "descripcion": "Implementar sistema de login",
    "estado": "pendiente",
    "prioridad": "alta",
    "fecha_creacion": "2024-11-06T16:45:00.123456",
    "proyecto_id": 1
  },
  {
    "id": 2,
    "descripcion": "Dise√±ar base de datos",
    "estado": "completada",
    "prioridad": "media",
    "fecha_creacion": "2024-11-06T17:00:00.123456",
    "proyecto_id": 1
  }
]
```

---

### 8. Listar Todas las Tareas con Filtros

**Request b√°sico:**

```bash
curl -X GET http://localhost:8000/tareas
```

**Con filtros:**

```bash
# Filtrar por estado
curl -X GET "http://localhost:8000/tareas?estado=pendiente"

# Filtrar por prioridad
curl -X GET "http://localhost:8000/tareas?prioridad=alta"

# Filtrar por proyecto
curl -X GET "http://localhost:8000/tareas?proyecto_id=1"

# M√∫ltiples filtros con ordenamiento
curl -X GET "http://localhost:8000/tareas?estado=en_progreso&prioridad=alta&orden=desc"
```

**Par√°metros disponibles:**
- `estado`: pendiente | en_progreso | completada
- `prioridad`: baja | media | alta
- `proyecto_id`: ID num√©rico del proyecto
- `orden`: asc | desc

**Response (200):**

```json
[
  {
    "id": 3,
    "descripcion": "Configurar servidor de producci√≥n",
    "estado": "pendiente",
    "prioridad": "alta",
    "fecha_creacion": "2024-11-06T18:00:00.123456",
    "proyecto_id": 2
  }
]
```

---

### 9. Actualizar una Tarea

**Request:**

```bash
curl -X PUT http://localhost:8000/tareas/1 \
  -H "Content-Type: application/json" \
  -d '{
    "estado": "completada"
  }'
```

**JSON Body (actualizaci√≥n completa):**

```json
{
  "descripcion": "Implementar sistema de login con OAuth",
  "estado": "en_progreso",
  "prioridad": "alta",
  "proyecto_id": 1
}
```

**Response (200):**

```json
{
  "id": 1,
  "descripcion": "Implementar sistema de login con OAuth",
  "estado": "en_progreso",
  "prioridad": "alta",
  "fecha_creacion": "2024-11-06T16:45:00.123456",
  "proyecto_id": 1
}
```

---

### 10. Eliminar una Tarea

**Request:**

```bash
curl -X DELETE http://localhost:8000/tareas/1
```

**Response (200):**

```json
{
  "mensaje": "Tarea eliminada exitosamente"
}
```

---

### 11. Resumen de un Proyecto

**Request:**

```bash
curl -X GET http://localhost:8000/proyectos/1/resumen
```

**Response (200):**

```json
{
  "proyecto_id": 1,
  "proyecto_nombre": "Aplicaci√≥n Web E-commerce",
  "total_tareas": 8,
  "por_estado": {
    "pendiente": 3,
    "en_progreso": 2,
    "completada": 3
  },
  "por_prioridad": {
    "baja": 2,
    "media": 4,
    "alta": 2
  }
}
```

---

### 12. Resumen General del Sistema

**Request:**

```bash
curl -X GET http://localhost:8000/resumen
```

**Response (200):**

```json
{
  "total_proyectos": 5,
  "total_tareas": 23,
  "tareas_por_estado": {
    "pendiente": 8,
    "en_progreso": 6,
    "completada": 9
  },
  "proyecto_con_mas_tareas": {
    "id": 1,
    "nombre": "Aplicaci√≥n Web E-commerce",
    "cantidad_tareas": 8
  }
}
```

---

## üõ†Ô∏è Manejo de Errores

### C√≥digos de Estado HTTP

| C√≥digo | Significado                  | Cu√°ndo ocurre                                    |
|--------|------------------------------|--------------------------------------------------|
| 200    | OK                           | Operaci√≥n exitosa                                |
| 201    | Created                      | Recurso creado exitosamente                      |
| 400    | Bad Request                  | Datos inv√°lidos o proyecto inexistente           |
| 404    | Not Found                    | Recurso no encontrado                            |
| 409    | Conflict                     | Nombre de proyecto duplicado                     |
| 422    | Unprocessable Entity         | Error de validaci√≥n (Pydantic)                   |

### Ejemplos de Respuestas de Error

**404 - Proyecto no encontrado:**

```json
{
  "detail": "Proyecto no encontrado"
}
```

**409 - Nombre duplicado:**

```json
{
  "detail": "Ya existe un proyecto con ese nombre"
}
```

**422 - Error de validaci√≥n:**

```json
{
  "detail": [
    {
      "loc": ["body", "estado"],
      "msg": "Estado debe ser uno de: pendiente, en_progreso, completada",
      "type": "value_error"
    }
  ]
}
```

---

## üìù Notas Importantes

1. **Base de datos autom√°tica**: El archivo `proyectos.db` se crea autom√°ticamente al iniciar el servidor por primera vez.

2. **Validaciones estrictas**: Pydantic valida autom√°ticamente todos los datos de entrada. Los valores inv√°lidos retornan error 422.

3. **Eliminaci√≥n en cascada**: Al eliminar un proyecto, todas sus tareas se eliminan autom√°ticamente para mantener la integridad.

4. **Fechas en formato ISO 8601**: Todas las fechas se almacenan como strings en formato ISO (ej: `2024-11-06T15:30:00.123456`).

5. **Campos opcionales**: Los campos marcados como `Optional` pueden ser `null` o omitirse en actualizaciones parciales.

---

## üß™ Pruebas R√°pidas

### Script de prueba completo:

```bash
# 1. Crear proyecto
curl -X POST http://localhost:8000/proyectos \
  -H "Content-Type: application/json" \
  -d '{"nombre": "Test Project", "descripcion": "Proyecto de prueba"}'

# 2. Crear tarea
curl -X POST http://localhost:8000/proyectos/1/tareas \
  -H "Content-Type: application/json" \
  -d '{"descripcion": "Tarea de prueba", "prioridad": "alta"}'

# 3. Ver resumen
curl -X GET http://localhost:8000/proyectos/1/resumen

# 4. Listar tareas con filtros
curl -X GET "http://localhost:8000/tareas?estado=pendiente"
```

---

## üìö Recursos Adicionales

- **Documentaci√≥n FastAPI**: https://fastapi.tiangolo.com
- **Documentaci√≥n Pydantic**: https://docs.pydantic.dev
- **SQLite Documentation**: https://www.sqlite.org/docs.html

---

## üë§ Autor

Sistema desarrollado con FastAPI para la gesti√≥n eficiente de proyectos y tareas.

**Versi√≥n**: 1.0.0